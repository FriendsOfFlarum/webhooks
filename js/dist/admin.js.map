{"version":3,"sources":["webpack://@reflar/webhooks/webpack/bootstrap","webpack://@reflar/webhooks/external \"flarum.core.compat['Model']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Button']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Select']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['app']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Alert']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['models/Forum']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['utils/mixin']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['extend']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/AdminNav']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Page']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['Component']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Modal']\"","webpack://@reflar/webhooks/external \"flarum.core.compat['components/Switch']\"","webpack://@reflar/webhooks/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@reflar/webhooks/./src/admin/models/Webhook.js","webpack://@reflar/webhooks/./src/admin/components/WebhookEditModal.js","webpack://@reflar/webhooks/./src/admin/components/SettingsListItem.js","webpack://@reflar/webhooks/./src/admin/components/SettingsPage.js","webpack://@reflar/webhooks/./src/admin/index.js","webpack://@reflar/webhooks/./src/admin/addSettingsPage.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","flarum","core","compat","_inheritsLoose","subClass","superClass","constructor","__proto__","Webhook_Webhook","mixin_default","external_flarum_core_compat_Model_default","a","id","attribute","service","url","error","events","def","str","JSON","parse","transformJSON","WebhookEditModal_WebhookEditModal","init","_Modal","this","webhook","props","app","forum","reduce","obj","evt","exec","Other","push","full","sort","group","className","title","translator","trans","content","_this","entries","prop","b","propA","toUpperCase","propB","sortByProp","map","_ref","length","event","Switch_default","component","state","includes","children","onchange","checked","loading","splice","indexOf","updateWebhook","then","lazyRedraw","Modal_default","SettingsListItem_SettingsListItem","view","_this$props","services","onChange","onDelete","Select_default","options","type","placeholder","withAttr","Button_default","icon","onclick","modal","show","Alert_default","dismissible","external_flarum_core_compat_Component_default","SettingsPage_SettingsPage","_Page","values","webhooks","settingsPrefix","newWebhook","deleteWebhook","addWebhook","_this2","request","method","data","response","attributes","catch","field","_data","some","w","changed","_this3","fields","settings","addPrefix","Page_default","external_flarum_core_compat_app_default","initializers","add","store","models","Forum_default","hasMany","routes","path","extensionSettings","route","external_flarum_core_compat_extend_","AdminNav_default","items","AdminLinkButton_default","href","description"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/Select'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['models/Forum'];","module.exports = flarum.core.compat['utils/mixin'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Switch'];","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nconst transformJSON = def => str => (str ? JSON.parse(str) : def);\n\nexport default class Webhook extends mixin(Model, {\n    id: Model.attribute('id'),\n    service: Model.attribute('service'),\n    url: Model.attribute('url'),\n    error: Model.attribute('error'),\n    events: Model.attribute('events', transformJSON([])),\n}) {}\n","import Modal from 'flarum/components/Modal';\nimport Switch from 'flarum/components/Switch';\n\nconst sortByProp = prop => (a, b) => {\n    const propA = a[prop].toUpperCase(); // ignore upper and lowercase\n    const propB = b[prop].toUpperCase(); // ignore upper and lowercase\n\n    return propA < propB ? -1 : (propA > propB ? 1 : 0);\n};\n\nexport default class WebhookEditModal extends Modal {\n    init() {\n        super.init();\n\n        this.webhook = this.props.webhook;\n\n        const events = app.forum.attribute('reflar-webhooks.events');\n\n        this.events = events.reduce(\n            (obj, evt) => {\n                const m = /((?:[a-z]+\\\\?)+?)\\\\Event\\\\([a-z]+)/i.exec(evt);\n\n                if (!m) {\n                    obj.Other.push({\n                        full: evt,\n                        name: evt,\n                    });\n                    obj.Other = obj.Other.sort();\n                    return obj;\n                }\n\n                const group = m[1];\n\n                if (!obj[group]) obj[group] = [];\n\n                obj[group].push({\n                    full: evt,\n                    name: m[2],\n                });\n                obj[group] = obj[group].sort();\n\n                return obj;\n            },\n            { Other: [] }\n        );\n    }\n\n    className() {\n        return 'Modal--medium';\n    }\n\n    title() {\n        return app.translator.trans('reflar-webhooks.admin.settings.modal.title');\n    }\n\n    content() {\n        return (\n            <div className=\"ReflarWebhooksModal Modal-body\">\n                {app.translator.trans('reflar-webhooks.admin.settings.modal.description')}\n                <div className=\"Webhook-events\">\n                    {Object.entries(this.events).sort(sortByProp(0)).map(\n                        ([group, events]) =>\n                            events.length ? (\n                                <div>\n                                    <h3>{group}</h3>\n                                    {events.map(event =>\n                                        Switch.component({\n                                            state: this.webhook.events().includes(event.full),\n                                            children: event.name,\n                                            onchange: this.onchange.bind(this, event.full),\n                                        })\n                                    )}\n                                </div>\n                            ) : null\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    onchange(event, checked, component) {\n        component.loading = true;\n\n        let events = this.webhook.events();\n\n        if (checked) {\n            events.push(event);\n        } else {\n            events.splice(events.indexOf(event), 1);\n        }\n\n        return this.props.updateWebhook(events).then(() => {\n            component.loading = false;\n            m.lazyRedraw();\n        });\n    }\n}\n","import Component from 'flarum/Component';\nimport Select from 'flarum/components/Select';\nimport Button from 'flarum/components/Button';\nimport Alert from 'flarum/components/Alert';\nimport WebhookEditModal from './WebhookEditModal';\n\nexport default class SettingsListItem extends Component {\n    view() {\n        const { webhook, services, onChange, onDelete } = this.props;\n\n        return (\n            <div className=\"Webhooks--row\">\n                <div className=\"Webhook-input\">\n                    {Select.component({\n                        options: services,\n                        value: webhook.service(),\n                        onchange: value => onChange(webhook, 'service', value),\n                    })}\n                    <input\n                        className=\"FormControl Webhook-url\"\n                        type=\"url\"\n                        value={webhook.url()}\n                        placeholder={app.translator.trans('reflar-webhooks.admin.settings.help.url')}\n                        onchange={m.withAttr('value', value => onChange(webhook, 'url', value))}\n                    />\n                    {Button.component({\n                        type: 'button',\n                        className: 'Button Webhook-button',\n                        icon: 'fas fa-edit',\n                        onclick: () =>\n                            app.modal.show(\n                                new WebhookEditModal({\n                                    webhook,\n                                    updateWebhook: events => onChange(webhook, 'events', events),\n                                })\n                            ),\n                    })}\n                    {Button.component({\n                        type: 'button',\n                        className: 'Button Button--warning Webhook-button',\n                        icon: 'fas fa-times',\n                        onclick: () => onDelete(webhook),\n                    })}\n                </div>\n\n                {!webhook.events().length &&\n                    Alert.component({\n                        className: 'Webhook-error',\n                        children: app.translator.trans('reflar-webhooks.admin.settings.help.disabled'),\n                        dismissible: false,\n                    })}\n\n                {webhook.error &&\n                    webhook.error() &&\n                    Alert.component({\n                        children: webhook.error(),\n                        className: 'Webhook-error',\n                        type: 'error',\n                        dismissible: false,\n                    })}\n            </div>\n        );\n    }\n}\n","import Button from 'flarum/components/Button';\nimport Page from 'flarum/components/Page';\nimport Select from 'flarum/components/Select';\nimport SettingsListItem from './SettingsListItem';\nimport Webhook from '../models/Webhook';\n\nexport default class SettingsPage extends Page {\n    init() {\n        super.init();\n\n        this.values = {};\n        this.services = app.forum.attribute('reflar-webhooks.services').reduce((o, service) => {\n            o[service] = app.translator.trans(`reflar-webhooks.admin.settings.services.${service}`);\n            return o;\n        }, {});\n\n        this.webhooks = app.forum.webhooks();\n\n        this.settingsPrefix = 'reflar.webhooks';\n\n        this.newWebhook = {\n            service: m.prop('discord'),\n            url: m.prop(''),\n            loading: m.prop(false),\n        };\n    }\n\n    /**\n     * @returns {*}\n     */\n    view() {\n        return (\n            <div className=\"WebhooksPage\">\n                <div className=\"container\">\n                    <form>\n                        <h2>{app.translator.trans('reflar-webhooks.admin.settings.title')}</h2>\n                        <p className=\"helpText\">{app.translator.trans('reflar-webhooks.admin.settings.help.general')}</p>\n                        <fieldset>\n                            <div className=\"Webhooks--Container\">\n                                {this.webhooks.map(webhook =>\n                                    SettingsListItem.component({\n                                        webhook,\n                                        services: this.services,\n                                        onChange: this.updateWebhook.bind(this),\n                                        onDelete: this.deleteWebhook.bind(this),\n                                    })\n                                )}\n                                <div className=\"Webhooks--row\">\n                                    <div className=\"Webhook-input\">\n                                        {Select.component({\n                                            options: this.services,\n                                            value: this.newWebhook.service(),\n                                            onchange: this.newWebhook.service,\n                                        })}\n                                        <input\n                                            className=\"FormControl Webhook-url\"\n                                            type=\"url\"\n                                            placeholder={app.translator.trans('reflar-webhooks.admin.settings.help.url')}\n                                            onchange={m.withAttr('value', this.newWebhook.url)}\n                                        />\n                                        {Button.component({\n                                            type: 'button',\n                                            loading: this.newWebhook.loading(),\n                                            className: 'Button Button--warning Webhook-button',\n                                            icon: 'fas fa-plus',\n                                            onclick: this.addWebhook.bind(this),\n                                        })}\n                                    </div>\n                                </div>\n                            </div>\n                        </fieldset>\n                    </form>\n                </div>\n            </div>\n        );\n    }\n\n    addWebhook() {\n        this.newWebhook.loading(true);\n\n        return app\n            .request({\n                method: 'POST',\n                url: `${app.forum.attribute('apiUrl')}/reflar/webhooks`,\n                data: {\n                    service: this.newWebhook.service(),\n                    url: this.newWebhook.url(),\n                },\n            })\n            .then(response => {\n                this.webhooks.push({\n                    id: m.prop(response.data.id),\n                    service: m.prop(response.data.attributes.service),\n                    url: m.prop(response.data.attributes.url),\n                    events: m.prop([]),\n                });\n\n                this.newWebhook.service('discord');\n                this.newWebhook.url('');\n                this.newWebhook.loading(false);\n\n                m.lazyRedraw();\n            })\n            .catch(() => {\n                this.newWebhook.loading(false);\n\n                m.lazyRedraw();\n            });\n    }\n\n    updateWebhook(webhook, field, value) {\n        this.webhooks.some(w => {\n            if (w.id() === webhook.id()) {\n                w[field] = m.prop(value);\n                return true;\n            }\n        });\n\n        return app.request({\n            method: 'PATCH',\n            url: `${app.forum.attribute('apiUrl')}/reflar/webhooks/${webhook.id()}`,\n            data: {\n                [field]: value,\n            },\n        });\n    }\n\n    deleteWebhook(webhook) {\n        this.webhooks.splice(this.webhooks.indexOf(webhook), 1);\n\n        return app.request({\n            method: 'DELETE',\n            url: `${app.forum.attribute('apiUrl')}/reflar/webhooks/${webhook.id()}`,\n        });\n    }\n\n    /**\n     * @returns boolean\n     */\n    changed() {\n        return this.fields.some(key => this.values[key]() !== (app.data.settings[this.addPrefix(key)] || ''));\n    }\n}\n","import app from 'flarum/app';\nimport Model from 'flarum/Model';\nimport Forum from 'flarum/models/Forum';\n\nimport Webhook from './models/Webhook';\nimport addSettingsPage from './addSettingsPage';\n\napp.initializers.add('reflar/webhooks', () => {\n    app.store.models.webhooks = Webhook;\n\n    Forum.prototype.webhooks = Model.hasMany('webhooks');\n\n    addSettingsPage();\n});\n","import { extend } from 'flarum/extend';\nimport AdminNav from 'flarum/components/AdminNav';\nimport AdminLinkButton from 'flarum/components/AdminLinkButton';\n\nimport SettingsPage from './components/SettingsPage';\n\nexport default function() {\n    app.routes['reflar-webhooks'] = { path: '/reflar/webhooks', component: SettingsPage.component() };\n\n    app.extensionSettings['reflar-webhooks'] = () => m.route(app.route('reflar-webhooks'));\n\n    extend(AdminNav.prototype, 'items', items => {\n        items.add(\n            'reflar-webhooks',\n            AdminLinkButton.component({\n                href: app.route('reflar-webhooks'),\n                icon: 'fas fa-external-link-alt',\n                children: 'Webhooks',\n                description: app.translator.trans('reflar-webhooks.admin.nav.desc'),\n            })\n        );\n    });\n}\n"],"sourceRoot":""}